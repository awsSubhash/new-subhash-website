<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <style>
        .admin-panel {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            background: rgba(26, 26, 26, 0.9);
            backdrop-filter: blur(12px);
            border-radius: 10px;
        }
        .admin-section {
            margin-bottom: 2rem;
        }
        .admin-section textarea, .admin-section input {
            width: 100%;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 153, 0, 0.2);
            border-radius: 5px;
            padding: 10px;
            color: #fff;
        }
        .admin-section button {
            padding: 10px 20px;
            background: linear-gradient(90deg, #ff9900, #e68a00);
            border: none;
            border-radius: 5px;
            color: #0a0a0a;
            font-weight: 600;
            cursor: pointer;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="admin-panel">
        <h1>Admin Dashboard</h1>
        
        <div class="admin-section">
            <h2>About Me</h2>
            <textarea id="about-content" rows="5"></textarea>
            <button onclick="saveContent('about')">Save</button>
        </div>

        <div class="admin-section">
            <h2>Skills</h2>
            <input id="skill-name" placeholder="Skill Name (e.g., AWS)">
            <input id="skill-icon" placeholder="Font Awesome Icon (e.g., fa-cloud)">
            <button onclick="addSkill()">Add</button>
            <div id="skills-list"></div>
        </div>

        <div class="admin-section">
            <h2>Projects & Experience</h2>
            <input id="project-title" placeholder="Project/Role Title">
            <input id="project-company" placeholder="Company">
            <input id="project-duration" placeholder="Duration (e.g., Jan 2024 - Present)">
            <input id="project-image" placeholder="Image URL (optional)">
            <textarea id="project-description" placeholder="Description (one point per line)"></textarea>
            <button onclick="addProject()">Add</button>
            <div id="projects-list"></div>
        </div>

        <div class="admin-section">
            <h2>Blog</h2>
            <input id="blog-title" placeholder="Blog Title">
            <textarea id="blog-excerpt" placeholder="Excerpt"></textarea>
            <button onclick="addBlogPost()">Add</button>
            <div id="blog-list"></div>
        </div>

        <div class="admin-section">
            <h2>Testimonials</h2>
            <textarea id="testimonial-text" placeholder="Testimonial"></textarea>
            <input id="testimonial-author" placeholder="Author">
            <button onclick="addTestimonial()">Add</button>
            <div id="testimonials-list"></div>
        </div>

        <div class="admin-section">
            <h2>Education & Certifications</h2>
            <input id="education-title" placeholder="Degree/Certification Title">
            <input id="education-institution" placeholder="Institution">
            <input id="education-year" placeholder="Year">
            <input id="education-validation" placeholder="Validation Number (optional)">
            <button onclick="addEducation()">Add</button>
            <div id="education-list"></div>
        </div>
    </div>

    <script>
        async function fetchAdminContent() {
            const response = await fetch('/api/content');
            const data = await response.json();
            
            document.getElementById('about-content').value = data.about;
            document.getElementById('skills-list').innerHTML = data.skills.map(skill => `
                <div>${skill.name} (${skill.icon}) <button onclick="deleteSkill('${skill.name}')">Delete</button></div>
            `).join('');
            document.getElementById('projects-list').innerHTML = data.projects.map(project => `
                <div>${project.title} (${project.company}) <button onclick="deleteProject('${project.title}')">Delete</button></div>
            `).join('');
            document.getElementById('blog-list').innerHTML = data.blog.map(post => `
                <div>${post.title} <button onclick="deleteBlogPost('${post.title}')">Delete</button></div>
            `).join('');
            document.getElementById('testimonials-list').innerHTML = data.testimonials.map(testimonial => `
                <div>${testimonial.author} <button onclick="deleteTestimonial('${testimonial.author}')">Delete</button></div>
            `).join('');
            document.getElementById('education-list').innerHTML = data.education.map(edu => `
                <div>${edu.title} (${edu.institution}) <button onclick="deleteEducation('${edu.title}')">Delete</button></div>
            `).join('');
        }

        async function saveContent(section) {
            const content = document.getElementById(`${section}-content`).value;
            await fetch('/api/content', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ [section]: content })
            });
            alert('Content saved!');
        }

        async function addSkill() {
            const name = document.getElementById('skill-name').value;
            const icon = document.getElementById('skill-icon').value;
            if (name && icon) {
                await fetch('/api/content/skills', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, icon })
                });
                fetchAdminContent();
            }
        }

        async function addProject() {
            const title = document.getElementById('project-title').value;
            const company = document.getElementById('project-company').value;
            const duration = document.getElementById('project-duration').value;
            const image = document.getElementById('project-image').value;
            const description = document.getElementById('project-description').value.split('\n').filter(item => item.trim());
            if (title && company && duration && description.length) {
                await fetch('/api/content/projects', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ title, company, duration, description, image })
                });
                fetchAdminContent();
            }
        }

        async function addBlogPost() {
            const title = document.getElementById('blog-title').value;
            const excerpt = document.getElementById('blog-excerpt').value;
            if (title && excerpt) {
                await fetch('/api/content/blog', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ title, excerpt })
                });
                fetchAdminContent();
            }
        }

        async function addTestimonial() {
            const text = document.getElementById('testimonial-text').value;
            const author = document.getElementById('testimonial-author').value;
            if (text && author) {
                await fetch('/api/content/testimonials', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text, author })
                });
                fetchAdminContent();
            }
        }

        async function addEducation() {
            const title = document.getElementById('education-title').value;
            const institution = document.getElementById('education-institution').value;
            const year = document.getElementById('education-year').value;
            const validation = document.getElementById('education-validation').value;
            if (title && institution && year) {
                await fetch('/api/content/education', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ title, institution, year, validation })
                });
                fetchAdminContent();
            }
        }

        async function deleteSkill(name) {
            await fetch('/api/content/skills', {
                method: 'DELETE',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name })
            });
            fetchAdminContent();
        }

        async function deleteProject(title) {
            await fetch('/api/content/projects', {
                method: 'DELETE',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ title })
            });
            fetchAdminContent();
        }

        async function deleteBlogPost(title) {
            await fetch('/api/content/blog', {
                method: 'DELETE',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ title })
            });
            fetchAdminContent();
        }

        async function deleteTestimonial(author) {
            await fetch('/api/content/testimonials', {
                method: 'DELETE',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ author })
            });
            fetchAdminContent();
        }

        async function deleteEducation(title) {
            await fetch('/api/content/education', {
                method: 'DELETE',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ title })
            });
            fetchAdminContent();
        }

        fetchAdminContent();
    </script>
</body>
</html>
